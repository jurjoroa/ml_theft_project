{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "813f3b0d",
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "import numpy as np\n",
    "import matplotlib.pyplot as plt"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "7feea046",
   "metadata": {},
   "outputs": [],
   "source": [
    "%cd \"Documents/GitHub/pmx_gasoline_theft_prediction/\""
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "25385578",
   "metadata": {},
   "outputs": [],
   "source": [
    "df_pmx_00_19 = pd.read_excel(\"data-raw/PMX_00_19_Serendipia.xlsx\", low_memory=False)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "d1809c54",
   "metadata": {},
   "outputs": [],
   "source": [
    "df_pmx_00_19 = pd.read_excel(\"data-raw/PMX_00_19_Serendipia.xlsx\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "f254ae03",
   "metadata": {},
   "outputs": [],
   "source": [
    "df_pmx_00_19_lw = df_pmx_00_19[\"estado\", \"municipio\"].str.lower()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "0a4c7efb",
   "metadata": {},
   "outputs": [],
   "source": [
    "df_pmx_00_19_lw = df_pmx_00_19[\"estado\"].str.lower()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "8411f00c",
   "metadata": {},
   "outputs": [],
   "source": [
    "df_pmx_00_19_lw = df_pmx_00_19.str.lower()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "c0844e36",
   "metadata": {},
   "outputs": [],
   "source": [
    "df_pmx_00_19_lw = df_pmx_00_19[].str.lower()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "09eaa6be",
   "metadata": {},
   "outputs": [],
   "source": [
    "df_pmx_00_19_lw = df_pmx_00_19[\"year\", \"estado\"].str.lower()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "f59bb5bc",
   "metadata": {},
   "outputs": [],
   "source": [
    "df_pmx_00_19[\"estado\"] = df_pmx_00_19[\"estado\"].str.lower()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "258e2dad",
   "metadata": {},
   "outputs": [],
   "source": [
    "df_pmx_00_19[\"estado\"] = df_pmx_00_19[\"estado\"].str.lower()\n",
    "df_pmx_00_19[\"municipio\"] = df_pmx_00_19[\"municipio\"].str.lower()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "2a60a89b",
   "metadata": {},
   "outputs": [],
   "source": [
    "df_pmx_00_19_lw[\"estado\"] = df_pmx_00_19[\"estado\"].str.lower()\n",
    "df_pmx_00_19_lw[\"municipio\"] = df_pmx_00_19[\"municipio\"].str.lower()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "fe3dc441",
   "metadata": {},
   "outputs": [],
   "source": [
    "df_pmx_00_19 = pd.read_excel(\"data-raw/PMX_00_19_Serendipia.xlsx\")\n",
    "\n",
    "df_pmx_00_19_lw = df_pmx_00_19"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "597dadf3",
   "metadata": {},
   "outputs": [],
   "source": [
    "df_pmx_00_19_lw[\"estado\"] = df_pmx_00_19_lw[\"estado\"].str.lower()\n",
    "df_pmx_00_19_lw[\"municipio\"] = df_pmx_00_19_lw[\"municipio\"].str.lower()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "id": "3aceeca2",
   "metadata": {},
   "outputs": [],
   "source": [
    "df_pmx_00_19_lw[\"estado\"] = df_pmx_00_19_lw[\"estado\"].str.lower()\n",
    "df_pmx_00_19_lw[\"municipio\"] = df_pmx_00_19_lw[\"municipio\"].str.lower()\n",
    "df_pmx_00_19_lw[\"estado\"] = df_pmx_00_19_lw[\"estado\"].str.rstrip()\n",
    "df_pmx_00_19_lw[\"municipio\"] = df_pmx_00_19_lw[\"municipio\"].str.rstrip()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "8806aa39",
   "metadata": {},
   "outputs": [],
   "source": [
    "df_pmx_00_19_lw[\"estado\"] = df_pmx_00_19_lw[\"estado\"].str.lower()\n",
    "df_pmx_00_19_lw[\"municipio\"] = df_pmx_00_19_lw[\"municipio\"].str.lower()\n",
    "df_pmx_00_19_lw[\"estado\"] = df_pmx_00_19_lw[\"estado\"].str.replace(' ', '')\n",
    "df_pmx_00_19_lw[\"municipio\"] = df_pmx_00_19_lw[\"municipio\"].str.replace(' ', '')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "id": "97742238",
   "metadata": {},
   "outputs": [],
   "source": [
    "df_pmx_00_19_lw[\"estado\"] = df_pmx_00_19_lw[\"estado\"].str.lower(df_pmx_00_19_lw[\"estado\"] = df_pmx_00_19_lw[\"estado\"].str.replace(' ', ''))\n",
    "df_pmx_00_19_lw[\"municipio\"] = df_pmx_00_19_lw[\"municipio\"].str.lower(df_pmx_00_19_lw[\"municipio\"] = df_pmx_00_19_lw[\"municipio\"].str.replace(' ', ''))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "id": "263a7e8d",
   "metadata": {},
   "outputs": [],
   "source": [
    "df_pmx_00_19_lw[\"estado\"] = df_pmx_00_19_lw[\"estado\"].str.lower(.str.replace(' ', ''))\n",
    "df_pmx_00_19_lw[\"municipio\"] = df_pmx_00_19_lw[\"municipio\"].str.lower(.str.replace(' ', ''))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "id": "5021a1cd",
   "metadata": {},
   "outputs": [],
   "source": [
    "df_pmx_00_19_lw[\"estado\"] = df_pmx_00_19_lw[\"estado\"].str.lower().str.replace(' ', '')\n",
    "df_pmx_00_19_lw[\"municipio\"] = df_pmx_00_19_lw[\"municipio\"].str.lower().str.replace(' ', '')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "id": "e5b41086",
   "metadata": {},
   "outputs": [],
   "source": [
    "def remove_accents(a):\n",
    "    return unidecode.unidecode(a.decode('utf-8'))\n",
    "\n",
    "df_pmx_00_19_lw[\"estado\"] = df_pmx_00_19_lw[\"estado\"].str.lower().str.replace(' ', '').apply(remove_accents)\n",
    "df_pmx_00_19_lw[\"municipio\"] = df_pmx_00_19_lw[\"municipio\"].str.lower().str.replace(' ', '').apply(remove_accents)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "id": "a80233e8",
   "metadata": {},
   "outputs": [],
   "source": [
    "\n",
    "\n",
    "df_pmx_00_19_lw[\"estado\"] = df_pmx_00_19_lw[\"estado\"].str.lower().str.replace(' ', '').str.normalize('NFKD').str.encode('ascii',errors='ignore').str.decode('utf-8')\n",
    "df_pmx_00_19_lw[\"municipio\"] = df_pmx_00_19_lw[\"municipio\"].str.lower().str.replace(' ', '').str.normalize('NFKD').str.encode('ascii',errors='ignore').str.decode('utf-8')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "id": "472a81aa",
   "metadata": {},
   "outputs": [],
   "source": [
    "df_pmx_00_19 = pd.read_excel(\"data-raw/PMX_00_19_Serendipia.xlsx\")\n",
    "\n",
    "df_codes_mx = pd.read_excel(\"data-raw/codigo municipio inegi.xlsx\")\n",
    "\n",
    "df_pmx_00_19_lw = df_pmx_00_19"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "id": "e56bfe49",
   "metadata": {},
   "outputs": [],
   "source": [
    "df_pmx_00_19 = pd.read_excel(\"data-raw/PMX_00_19_Serendipia.xlsx\")\n",
    "\n",
    "df_codes_mx = pd.read_excel(\"data-raw/codigo municipio inegi.xlsx\")\n",
    "\n",
    "df_pmx_00_19_lw = df_pmx_00_19\n",
    "\n",
    "df_codes_mx_lw = df_codes_mx"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "id": "99289a55",
   "metadata": {},
   "outputs": [],
   "source": [
    "\n",
    "\n",
    "df_pmx_00_19_lw[\"estado\"] = df_pmx_00_19_lw[\"estado\"].str.lower().str.replace(' ', '').str.normalize('NFKD').str.encode('ascii',errors='ignore').str.decode('utf-8')\n",
    "df_pmx_00_19_lw[\"municipio\"] = df_pmx_00_19_lw[\"municipio\"].str.lower().str.replace(' ', '').str.normalize('NFKD').str.encode('ascii',errors='ignore').str.decode('utf-8')\n",
    "\n",
    "df_codes_mx_lw[\"NOM_ENT\"] = df_codes_mx_lw[\"NOM_ENT\"].str.lower().str.replace(' ', '').str.normalize('NFKD').str.encode('ascii',errors='ignore').str.decode('utf-8')\n",
    "df_codes_mx_lw[\"NOM_MUN\"] = df_codes_mx_lw[\"NOM_MUN\"].str.lower().str.replace(' ', '').str.normalize('NFKD').str.encode('ascii',errors='ignore').str.decode('utf-8')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "id": "f79aed3e",
   "metadata": {},
   "outputs": [],
   "source": [
    "\n",
    "\n",
    "df_pmx_00_19_lw[\"estado\"] = df_pmx_00_19_lw[\"estado\"].str.lower().str.replace(' ', '').str.normalize('NFKD').str.encode('ascii',errors='ignore').str.decode('utf-8')\n",
    "df_pmx_00_19_lw[\"municipio\"] = df_pmx_00_19_lw[\"municipio\"].str.lower().str.replace(' ', '').str.normalize('NFKD').str.encode('ascii',errors='ignore').str.decode('utf-8')\n",
    "df_pmx_00_19_lw.assign(id_mun = estado + municipio)\n",
    "\n",
    "\n",
    "df_codes_mx_lw[\"NOM_ENT\"] = df_codes_mx_lw[\"NOM_ENT\"].str.lower().str.replace(' ', '').str.normalize('NFKD').str.encode('ascii',errors='ignore').str.decode('utf-8')\n",
    "df_codes_mx_lw[\"NOM_MUN\"] = df_codes_mx_lw[\"NOM_MUN\"].str.lower().str.replace(' ', '').str.normalize('NFKD').str.encode('ascii',errors='ignore').str.decode('utf-8')\n",
    "df_codes_mx_lw.assign(id_mun = NOM_ENT + NOM_MUN)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "id": "24a81ea9",
   "metadata": {},
   "outputs": [],
   "source": [
    "\n",
    "\n",
    "df_pmx_00_19_lw[\"estado\"] = df_pmx_00_19_lw[\"estado\"].str.lower().str.replace(' ', '').str.normalize('NFKD').str.encode('ascii',errors='ignore').str.decode('utf-8')\n",
    "df_pmx_00_19_lw[\"municipio\"] = df_pmx_00_19_lw[\"municipio\"].str.lower().str.replace(' ', '').str.normalize('NFKD').str.encode('ascii',errors='ignore').str.decode('utf-8')\n",
    "df_pmx_00_19_lw.assign(id_mun = \"estado\" + \"municipio\")\n",
    "\n",
    "\n",
    "df_codes_mx_lw[\"NOM_ENT\"] = df_codes_mx_lw[\"NOM_ENT\"].str.lower().str.replace(' ', '').str.normalize('NFKD').str.encode('ascii',errors='ignore').str.decode('utf-8')\n",
    "df_codes_mx_lw[\"NOM_MUN\"] = df_codes_mx_lw[\"NOM_MUN\"].str.lower().str.replace(' ', '').str.normalize('NFKD').str.encode('ascii',errors='ignore').str.decode('utf-8')\n",
    "df_codes_mx_lw.assign(id_mun = \"NOM_ENT\" + \"NOM_MUN\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "id": "f3e3d264",
   "metadata": {},
   "outputs": [],
   "source": [
    "\n",
    "\n",
    "df_pmx_00_19_lw[\"estado\"] = df_pmx_00_19_lw[\"estado\"].str.lower().str.replace(' ', '').str.normalize('NFKD').str.encode('ascii',errors='ignore').str.decode('utf-8')\n",
    "df_pmx_00_19_lw[\"municipio\"] = df_pmx_00_19_lw[\"municipio\"].str.lower().str.replace(' ', '').str.normalize('NFKD').str.encode('ascii',errors='ignore').str.decode('utf-8')\n",
    "df_pmx_00_19_lw.assign(id_mun = \"estado\" + \"municipio\")\n",
    "\n",
    "\n",
    "df_codes_mx_lw[\"NOM_ENT\"] = df_codes_mx_lw[\"NOM_ENT\"].str.lower().str.replace(' ', '').str.normalize('NFKD').str.encode('ascii',errors='ignore').str.decode('utf-8')\n",
    "df_codes_mx_lw[\"NOM_MUN\"] = df_codes_mx_lw[\"NOM_MUN\"].str.lower().str.replace(' ', '').str.normalize('NFKD').str.encode('ascii',errors='ignore').str.decode('utf-8')\n",
    "df_codes_mx_lw = df_codes_mx_lw.assign(id_mun = \"NOM_ENT\" + \"NOM_MUN\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "id": "b5fedb92",
   "metadata": {},
   "outputs": [],
   "source": [
    "\n",
    "\n",
    "df_pmx_00_19_lw[\"estado\"] = df_pmx_00_19_lw[\"estado\"].str.lower().str.replace(' ', '').str.normalize('NFKD').str.encode('ascii',errors='ignore').str.decode('utf-8')\n",
    "df_pmx_00_19_lw[\"municipio\"] = df_pmx_00_19_lw[\"municipio\"].str.lower().str.replace(' ', '').str.normalize('NFKD').str.encode('ascii',errors='ignore').str.decode('utf-8')\n",
    "df_pmx_00_19_lw.assign(id_mun = \"estado\" + \"municipio\")\n",
    "\n",
    "\n",
    "df_codes_mx_lw[\"NOM_ENT\"] = df_codes_mx_lw[\"NOM_ENT\"].str.lower().str.replace(' ', '').str.normalize('NFKD').str.encode('ascii',errors='ignore').str.decode('utf-8')\n",
    "df_codes_mx_lw[\"NOM_MUN\"] = df_codes_mx_lw[\"NOM_MUN\"].str.lower().str.replace(' ', '').str.normalize('NFKD').str.encode('ascii',errors='ignore').str.decode('utf-8')\n",
    "df_codes_mx_lw = df_codes_mx_lw.assign(id_mun = \"NOM_ENT\" + \"NOM_MUN\")\n",
    "df_codes_mx_lw['id_mun'] = df_codes_mx_lw.NOM_ENT + df_codes_mx_lw.NOM_MUN"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 29,
   "id": "a0dfb129",
   "metadata": {},
   "outputs": [],
   "source": [
    "\n",
    "\n",
    "df_pmx_00_19_lw[\"estado\"] = df_pmx_00_19_lw[\"estado\"].str.lower().str.replace(' ', '').str.normalize('NFKD').str.encode('ascii',errors='ignore').str.decode('utf-8')\n",
    "df_pmx_00_19_lw[\"municipio\"] = df_pmx_00_19_lw[\"municipio\"].str.lower().str.replace(' ', '').str.normalize('NFKD').str.encode('ascii',errors='ignore').str.decode('utf-8')\n",
    "df_pmx_00_19_lw['id_mun'] = df_pmx_00_19_lw.estado + df_codes_mx_lw.municipio\n",
    "\n",
    "\n",
    "\n",
    "df_codes_mx_lw[\"NOM_ENT\"] = df_codes_mx_lw[\"NOM_ENT\"].str.lower().str.replace(' ', '').str.normalize('NFKD').str.encode('ascii',errors='ignore').str.decode('utf-8')\n",
    "df_codes_mx_lw[\"NOM_MUN\"] = df_codes_mx_lw[\"NOM_MUN\"].str.lower().str.replace(' ', '').str.normalize('NFKD').str.encode('ascii',errors='ignore').str.decode('utf-8')\n",
    "df_codes_mx_lw['id_mun'] = df_codes_mx_lw.NOM_ENT + df_codes_mx_lw.NOM_MUN"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 30,
   "id": "4a7dd10a",
   "metadata": {},
   "outputs": [],
   "source": [
    "\n",
    "\n",
    "df_pmx_00_19_lw[\"estado\"] = df_pmx_00_19_lw[\"estado\"].str.lower().str.replace(' ', '').str.normalize('NFKD').str.encode('ascii',errors='ignore').str.decode('utf-8')\n",
    "df_pmx_00_19_lw[\"municipio\"] = df_pmx_00_19_lw[\"municipio\"].str.lower().str.replace(' ', '').str.normalize('NFKD').str.encode('ascii',errors='ignore').str.decode('utf-8')\n",
    "df_pmx_00_19_lw['id_mun'] = df_pmx_00_19_lw.estado + df_pmx_00_19_lw.municipio\n",
    "\n",
    "\n",
    "\n",
    "df_codes_mx_lw[\"NOM_ENT\"] = df_codes_mx_lw[\"NOM_ENT\"].str.lower().str.replace(' ', '').str.normalize('NFKD').str.encode('ascii',errors='ignore').str.decode('utf-8')\n",
    "df_codes_mx_lw[\"NOM_MUN\"] = df_codes_mx_lw[\"NOM_MUN\"].str.lower().str.replace(' ', '').str.normalize('NFKD').str.encode('ascii',errors='ignore').str.decode('utf-8')\n",
    "df_codes_mx_lw['id_mun'] = df_codes_mx_lw.NOM_ENT + df_codes_mx_lw.NOM_MUN"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 31,
   "id": "735758d5",
   "metadata": {},
   "outputs": [],
   "source": [
    "df_pmx_00_19 = pd.read_excel(\"data-raw/PMX_00_19_Serendipia.xlsx\")\n",
    "\n",
    "df_codes_mx = pd.read_excel(\"data-raw/codigo municipio inegi.xlsx\")\n",
    "\n",
    "df_pmx_00_19_lw = df_pmx_00_19\n",
    "\n",
    "df_codes_mx_lw = df_codes_mx"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 32,
   "id": "19decdc8",
   "metadata": {},
   "outputs": [],
   "source": [
    "df_pmx_00_19 = pd.read_excel(\"data-raw/PMX_00_19_Serendipia.xlsx\")\n",
    "\n",
    "df_codes_mx = pd.read_excel(\"data-raw/codigo municipio inegi.xlsx\")\n",
    "\n",
    "df_pmx_00_19_lw = df_pmx_00_19\n",
    "\n",
    "df_codes_mx_lw = df_codes_mx\n",
    "\n",
    "df_pmx_00_19_lw = df_pmx_00_19_lw.replace(\"Coahuila de Zaragoza\", \"Coahuila\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 33,
   "id": "047095d8",
   "metadata": {},
   "outputs": [],
   "source": [
    "df_pmx_00_19 = pd.read_excel(\"data-raw/PMX_00_19_Serendipia.xlsx\")\n",
    "\n",
    "df_codes_mx = pd.read_excel(\"data-raw/codigo municipio inegi.xlsx\")\n",
    "\n",
    "df_pmx_00_19_lw = df_pmx_00_19\n",
    "\n",
    "df_codes_mx_lw = df_codes_mx\n",
    "\n",
    "df_codes_mx_lw = df_codes_mx_lw.replace(\"Coahuila de Zaragoza\", \"Coahuila\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 34,
   "id": "b1b7aabc",
   "metadata": {},
   "outputs": [],
   "source": [
    "df_pmx_00_19 = pd.read_excel(\"data-raw/PMX_00_19_Serendipia.xlsx\")\n",
    "\n",
    "df_codes_mx = pd.read_excel(\"data-raw/codigo municipio inegi.xlsx\")\n",
    "\n",
    "df_pmx_00_19_lw = df_pmx_00_19\n",
    "\n",
    "df_codes_mx_lw = df_codes_mx\n",
    "\n",
    "df_codes_mx_lw = df_codes_mx_lw.replace(\"Coahuila de Zaragoza\", \"Coahuila\")\n",
    "df_codes_mx_lw = df_codes_mx_lw.replace(\"Michoacán de Ocampo\", \"Michoacán\")\n",
    "df_codes_mx_lw = df_codes_mx_lw.replace(\"Veracruz de Ignacio de la Llave\", \"Veracruz\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 35,
   "id": "f2109feb",
   "metadata": {},
   "outputs": [],
   "source": [
    "df_pmx_00_19 = pd.read_excel(\"data-raw/PMX_00_19_Serendipia.xlsx\")\n",
    "\n",
    "df_codes_mx = pd.read_excel(\"data-raw/codigo municipio inegi.xlsx\")\n",
    "\n",
    "df_pmx_00_19_lw = df_pmx_00_19\n",
    "\n",
    "df_codes_mx_lw = df_codes_mx\n",
    "\n",
    "df_codes_mx_lw = df_codes_mx_lw.replace(\"Coahuila de Zaragoza\", \"Coahuila\")\n",
    "df_codes_mx_lw = df_codes_mx_lw.replace(\"Michoacán de Ocampo\", \"Michoacán\")\n",
    "df_codes_mx_lw = df_codes_mx_lw.replace(\"Veracruz de Ignacio de la Llave\", \"Veracruz\")\n",
    "\n",
    "df_pmx_00_19_lw[\"municipio\"].str.replace(\"Delegación\", \"\")\n",
    "df_pmx_00_19_lw[\"municipio\"].str.replace(\"Deleg. \", \"\")\n",
    "\n",
    "\n",
    "            \n",
    "                    \n",
    "df_pmx_00_19_lw[\"A\"].str.replace(\"a\",\"\")\n",
    "\n",
    "                \n",
    "\n",
    "            \n",
    "\n",
    "            "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 36,
   "id": "5793090a",
   "metadata": {},
   "outputs": [],
   "source": [
    "df_pmx_00_19 = pd.read_excel(\"data-raw/PMX_00_19_Serendipia.xlsx\")\n",
    "\n",
    "df_codes_mx = pd.read_excel(\"data-raw/codigo municipio inegi.xlsx\")\n",
    "\n",
    "df_pmx_00_19_lw = df_pmx_00_19\n",
    "\n",
    "df_codes_mx_lw = df_codes_mx\n",
    "\n",
    "df_codes_mx_lw = df_codes_mx_lw.replace(\"Coahuila de Zaragoza\", \"Coahuila\")\n",
    "df_codes_mx_lw = df_codes_mx_lw.replace(\"Michoacán de Ocampo\", \"Michoacán\")\n",
    "df_codes_mx_lw = df_codes_mx_lw.replace(\"Veracruz de Ignacio de la Llave\", \"Veracruz\")\n",
    "\n",
    "df_pmx_00_19_lw[\"municipio\"].str.replace(\"Delegación\", \"\")\n",
    "df_pmx_00_19_lw[\"municipio\"].str.replace(\"Deleg. \", \"\")\n",
    "\n",
    "                \n",
    "\n",
    "            \n",
    "\n",
    "            "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 37,
   "id": "60418708",
   "metadata": {},
   "outputs": [],
   "source": [
    "df_pmx_00_19 = pd.read_excel(\"data-raw/PMX_00_19_Serendipia.xlsx\")\n",
    "\n",
    "df_codes_mx = pd.read_excel(\"data-raw/codigo municipio inegi.xlsx\")\n",
    "\n",
    "df_pmx_00_19_lw = df_pmx_00_19\n",
    "\n",
    "df_codes_mx_lw = df_codes_mx\n",
    "\n",
    "df_codes_mx_lw = df_codes_mx_lw.replace(\"Coahuila de Zaragoza\", \"Coahuila\")\n",
    "df_codes_mx_lw = df_codes_mx_lw.replace(\"Michoacán de Ocampo\", \"Michoacán\")\n",
    "df_codes_mx_lw = df_codes_mx_lw.replace(\"Veracruz de Ignacio de la Llave\", \"Veracruz\")\n",
    "\n",
    "df_pmx_00_19_lw[\"municipio\"] = df_pmx_00_19_lw[\"municipio\"].str.replace(\"Delegación\", \"\")\n",
    "df_pmx_00_19_lw[\"municipio\"] = df_pmx_00_19_lw[\"municipio\"].str.replace(\"Deleg. \", \"\")\n",
    "\n",
    "                \n",
    "\n",
    "            \n",
    "\n",
    "            "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 38,
   "id": "dc3e9e06",
   "metadata": {},
   "outputs": [],
   "source": [
    "df_pmx_00_19 = pd.read_excel(\"data-raw/PMX_00_19_Serendipia.xlsx\")\n",
    "\n",
    "df_codes_mx = pd.read_excel(\"data-raw/codigo municipio inegi.xlsx\")\n",
    "\n",
    "df_pmx_00_19_lw = df_pmx_00_19\n",
    "\n",
    "df_codes_mx_lw = df_codes_mx\n",
    "\n",
    "dict_replacers_code = {\"Coahuila de Zaragoza\":\"Coahuila\",\"Michoacán de Ocampo\":\"Michoacán\",\n",
    "                       \"Veracruz de Ignacio de la Llave\":\"Veracruz\"} \n",
    "\n",
    "df_codes_mx_lw = df_codes_mx_lw.replace(dict_replacers_code)\n",
    "\n",
    "df_pmx_00_19_lw[\"municipio\"] = df_pmx_00_19_lw[\"municipio\"].str.replace(\"Delegación\", \"\")\n",
    "df_pmx_00_19_lw[\"municipio\"] = df_pmx_00_19_lw[\"municipio\"].str.replace(\"Deleg. \", \"\")\n",
    "\n",
    "                \n",
    "\n",
    "            \n",
    "\n",
    "            "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 39,
   "id": "591c8aee",
   "metadata": {},
   "outputs": [],
   "source": [
    "df_pmx_00_19 = pd.read_excel(\"data-raw/PMX_00_19_Serendipia.xlsx\")\n",
    "\n",
    "df_codes_mx = pd.read_excel(\"data-raw/codigo municipio inegi.xlsx\")\n",
    "\n",
    "df_pmx_00_19_lw = df_pmx_00_19\n",
    "\n",
    "df_codes_mx_lw = df_codes_mx\n",
    "\n",
    "dict_replacers_code = {\"Coahuila de Zaragoza\":\"Coahuila\",\"Michoacán de Ocampo\":\"Michoacán\",\n",
    "                       \"Veracruz de Ignacio de la Llave\":\"Veracruz\"} \n",
    "\n",
    "df_codes_mx_lw = df_codes_mx_lw.replace(dict_replacers_code)\n",
    "\n",
    "dict_replacers_string = {\"Delegación\":\"\",\"Deleg. \":\"\",\"Del. \":\"\"} \n",
    "\n",
    "df_pmx_00_19_lw[\"municipio\"] = df_pmx_00_19_lw[\"municipio\"].str.replace(dict_replacers_string)\n",
    "\n",
    "                \n",
    "\n",
    "            \n",
    "\n",
    "            "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 40,
   "id": "52c70c84",
   "metadata": {},
   "outputs": [],
   "source": [
    "df_pmx_00_19 = pd.read_excel(\"data-raw/PMX_00_19_Serendipia.xlsx\")\n",
    "\n",
    "df_codes_mx = pd.read_excel(\"data-raw/codigo municipio inegi.xlsx\")\n",
    "\n",
    "df_pmx_00_19_lw = df_pmx_00_19\n",
    "\n",
    "df_codes_mx_lw = df_codes_mx\n",
    "\n",
    "dict_replacers_code = {\"Coahuila de Zaragoza\":\"Coahuila\",\"Michoacán de Ocampo\":\"Michoacán\",\n",
    "                       \"Veracruz de Ignacio de la Llave\":\"Veracruz\"} \n",
    "\n",
    "df_codes_mx_lw = df_codes_mx_lw.replace(dict_replacers_code)\n",
    "\n",
    "dict_replacers_string = {\"Delegación\":\"\",\"Deleg. \":\"\",\"Del. \":\"\"} \n",
    "\n",
    "df_pmx_00_19_lw[\"municipio\"] = df_pmx_00_19_lw[\"municipio\"].replace(dict_replacers_string)\n",
    "\n",
    "\n",
    "                \n",
    "\n",
    "            \n",
    "\n",
    "            "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 41,
   "id": "d4755866",
   "metadata": {},
   "outputs": [],
   "source": [
    "df_pmx_00_19 = pd.read_excel(\"data-raw/PMX_00_19_Serendipia.xlsx\")\n",
    "\n",
    "df_codes_mx = pd.read_excel(\"data-raw/codigo municipio inegi.xlsx\")\n",
    "\n",
    "df_pmx_00_19_lw = df_pmx_00_19\n",
    "\n",
    "df_codes_mx_lw = df_codes_mx\n",
    "\n",
    "dict_replacers_code = {\"Coahuila de Zaragoza\":\"Coahuila\",\"Michoacán de Ocampo\":\"Michoacán\",\n",
    "                       \"Veracruz de Ignacio de la Llave\":\"Veracruz\"} \n",
    "\n",
    "df_codes_mx_lw = df_codes_mx_lw.replace(dict_replacers_code)\n",
    "\n",
    "dict_replacers_string = {\"Delegación\":\"\",\"Deleg. \":\"\",\"Del. \":\"\"} \n",
    "\n",
    "df_pmx_00_19_lw[\"municipio\"] = df_pmx_00_19_lw[\"municipio\"].replace(dict_replacers_string)\n",
    "\n",
    "\n",
    "                \n",
    "\n",
    "            \n",
    "\n",
    "            "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 42,
   "id": "eab6938f",
   "metadata": {},
   "outputs": [],
   "source": [
    "df_pmx_00_19 = pd.read_excel(\"data-raw/PMX_00_19_Serendipia.xlsx\")\n",
    "\n",
    "df_codes_mx = pd.read_excel(\"data-raw/codigo municipio inegi.xlsx\")\n",
    "\n",
    "df_pmx_00_19_lw = df_pmx_00_19\n",
    "\n",
    "df_codes_mx_lw = df_codes_mx\n",
    "\n",
    "dict_replacers_code = {\"Coahuila de Zaragoza\":\"Coahuila\",\"Michoacán de Ocampo\":\"Michoacán\",\n",
    "                       \"Veracruz de Ignacio de la Llave\":\"Veracruz\"} \n",
    "\n",
    "df_codes_mx_lw = df_codes_mx_lw.replace(dict_replacers_code)\n",
    "\n",
    "dict_replacers_string = {\"Delegación\":\"\",\"Deleg. \":\"\",\"Del. \":\"\"} \n",
    "\n",
    "df_pmx_00_19_lw[\"municipio\"] = df_pmx_00_19_lw[\"municipio\"].replace(dict_replacers_string)\n",
    "\n",
    "for k, v in dict_replacers_string.items():\n",
    "    df_pmx_00_19_lw[\"municipio\"] = df_pmx_00_19_lw[\"municipio\"].str.replace(k, v)               \n",
    "\n",
    "            \n",
    "\n",
    "            "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 43,
   "id": "d381b8f8",
   "metadata": {},
   "outputs": [],
   "source": [
    "df_pmx_00_19 = pd.read_excel(\"data-raw/PMX_00_19_Serendipia.xlsx\")\n",
    "\n",
    "df_codes_mx = pd.read_excel(\"data-raw/codigo municipio inegi.xlsx\")\n",
    "\n",
    "df_pmx_00_19_lw = df_pmx_00_19\n",
    "\n",
    "df_codes_mx_lw = df_codes_mx\n",
    "\n",
    "dict_replacers_code = {\"Coahuila de Zaragoza\":\"Coahuila\",\"Michoacán de Ocampo\":\"Michoacán\",\n",
    "                       \"Veracruz de Ignacio de la Llave\":\"Veracruz\"} \n",
    "\n",
    "df_codes_mx_lw = df_codes_mx_lw.replace(dict_replacers_code)\n",
    "\n",
    "dict_replacers_string = {\"Delegación\":\"\",\"Deleg. \":\"\",\"Del. \":\"\"} \n",
    "\n",
    "df_pmx_00_19_lw[\"municipio\"] = df_pmx_00_19_lw[\"municipio\"].replace(dict_replacers_string)\n",
    "\n",
    "for k, v in dict_replacers_string.items():\n",
    "    df_pmx_00_19_lw[\"municipio\"] = df_pmx_00_19_lw[\"municipio\"].str.replace(k, v)               "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 44,
   "id": "ecbe2064",
   "metadata": {},
   "outputs": [],
   "source": [
    "\n",
    "df_pmx_00_19_lw = df_pmx_00_19_lw.replace(\"Coahuila de Zaragoza\", \"Coahuila\")\n",
    "\n",
    "df_pmx_00_19_lw[\"estado\"] = df_pmx_00_19_lw[\"estado\"].str.lower().str.replace(' ', '').str.normalize('NFKD').str.encode('ascii',errors='ignore').str.decode('utf-8')\n",
    "df_pmx_00_19_lw[\"municipio\"] = df_pmx_00_19_lw[\"municipio\"].str.lower().str.replace(' ', '').str.normalize('NFKD').str.encode('ascii',errors='ignore').str.decode('utf-8')\n",
    "df_pmx_00_19_lw['id_mun'] = df_pmx_00_19_lw.estado + df_pmx_00_19_lw.municipio\n",
    "\n",
    "\n",
    "\n",
    "df_codes_mx_lw[\"NOM_ENT\"] = df_codes_mx_lw[\"NOM_ENT\"].str.lower().str.replace(' ', '').str.normalize('NFKD').str.encode('ascii',errors='ignore').str.decode('utf-8')\n",
    "df_codes_mx_lw[\"NOM_MUN\"] = df_codes_mx_lw[\"NOM_MUN\"].str.lower().str.replace(' ', '').str.normalize('NFKD').str.encode('ascii',errors='ignore').str.decode('utf-8')\n",
    "df_codes_mx_lw['id_mun'] = df_codes_mx_lw.NOM_ENT + df_codes_mx_lw.NOM_MUN"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 45,
   "id": "bdc3ac28",
   "metadata": {},
   "outputs": [],
   "source": [
    "\n",
    "df_pmx_00_19_lw = df_pmx_00_19_lw.replace(\"Coahuila de Zaragoza\", \"Coahuila\")\n",
    "\n",
    "df_pmx_00_19_lw[\"estado\"] = df_pmx_00_19_lw[\"estado\"].str.lower().str.replace(' ', '').str.normalize('NFKD').str.encode('ascii',errors='ignore').str.decode('utf-8')\n",
    "df_pmx_00_19_lw[\"municipio\"] = df_pmx_00_19_lw[\"municipio\"].str.lower().str.replace(' ', '').str.normalize('NFKD').str.encode('ascii',errors='ignore').str.decode('utf-8')\n",
    "df_pmx_00_19_lw['id_mun'] = df_pmx_00_19_lw.estado + df_pmx_00_19_lw.municipio\n",
    "\n",
    "\n",
    "\n",
    "df_codes_mx_lw[\"NOM_ENT\"] = df_codes_mx_lw[\"NOM_ENT\"].str.lower().str.replace(' ', '').str.normalize('NFKD').str.encode('ascii',errors='ignore').str.decode('utf-8')\n",
    "df_codes_mx_lw[\"NOM_MUN\"] = df_codes_mx_lw[\"NOM_MUN\"].str.lower().str.replace(' ', '').str.normalize('NFKD').str.encode('ascii',errors='ignore').str.decode('utf-8')\n",
    "df_codes_mx_lw['id_mun'] = df_codes_mx_lw.NOM_ENT + df_codes_mx_lw.NOM_MUN\n",
    "\n",
    "\n",
    "\n",
    "df_join_pipe_code = pd.merge(df_pmx_00_19_lw,\n",
    "                             df_codes_mx_lw,\n",
    "                             on='id_mun',\n",
    "                             how='outer',\n",
    "                             indicator=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 46,
   "id": "e6d074cf",
   "metadata": {},
   "outputs": [],
   "source": [
    "\n",
    "df_pmx_00_19_lw = df_pmx_00_19_lw.replace(\"Coahuila de Zaragoza\", \"Coahuila\")\n",
    "\n",
    "df_pmx_00_19_lw[\"estado\"] = df_pmx_00_19_lw[\"estado\"].str.lower().str.replace(' ', '').str.normalize('NFKD').str.encode('ascii',errors='ignore').str.decode('utf-8')\n",
    "df_pmx_00_19_lw[\"municipio\"] = df_pmx_00_19_lw[\"municipio\"].str.lower().str.replace(' ', '').str.normalize('NFKD').str.encode('ascii',errors='ignore').str.decode('utf-8')\n",
    "df_pmx_00_19_lw['id_mun'] = df_pmx_00_19_lw.estado + df_pmx_00_19_lw.municipio\n",
    "\n",
    "\n",
    "\n",
    "df_codes_mx_lw[\"NOM_ENT\"] = df_codes_mx_lw[\"NOM_ENT\"].str.lower().str.replace(' ', '').str.normalize('NFKD').str.encode('ascii',errors='ignore').str.decode('utf-8')\n",
    "df_codes_mx_lw[\"NOM_MUN\"] = df_codes_mx_lw[\"NOM_MUN\"].str.lower().str.replace(' ', '').str.normalize('NFKD').str.encode('ascii',errors='ignore').str.decode('utf-8')\n",
    "df_codes_mx_lw['id_mun'] = df_codes_mx_lw.NOM_ENT + df_codes_mx_lw.NOM_MUN\n",
    "\n",
    "\n",
    "\n",
    "df_join_pipe_code = pd.merge(df_pmx_00_19_lw,\n",
    "                             df_codes_mx_lw,\n",
    "                             on='id_mun',\n",
    "                             how='outer',\n",
    "                             indicator=True)\n",
    "\n",
    "\n",
    "summary.df_join_pipe_code['_merge']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 47,
   "id": "265e8c0b",
   "metadata": {},
   "outputs": [],
   "source": [
    "\n",
    "df_pmx_00_19_lw = df_pmx_00_19_lw.replace(\"Coahuila de Zaragoza\", \"Coahuila\")\n",
    "\n",
    "df_pmx_00_19_lw[\"estado\"] = df_pmx_00_19_lw[\"estado\"].str.lower().str.replace(' ', '').str.normalize('NFKD').str.encode('ascii',errors='ignore').str.decode('utf-8')\n",
    "df_pmx_00_19_lw[\"municipio\"] = df_pmx_00_19_lw[\"municipio\"].str.lower().str.replace(' ', '').str.normalize('NFKD').str.encode('ascii',errors='ignore').str.decode('utf-8')\n",
    "df_pmx_00_19_lw['id_mun'] = df_pmx_00_19_lw.estado + df_pmx_00_19_lw.municipio\n",
    "\n",
    "\n",
    "\n",
    "df_codes_mx_lw[\"NOM_ENT\"] = df_codes_mx_lw[\"NOM_ENT\"].str.lower().str.replace(' ', '').str.normalize('NFKD').str.encode('ascii',errors='ignore').str.decode('utf-8')\n",
    "df_codes_mx_lw[\"NOM_MUN\"] = df_codes_mx_lw[\"NOM_MUN\"].str.lower().str.replace(' ', '').str.normalize('NFKD').str.encode('ascii',errors='ignore').str.decode('utf-8')\n",
    "df_codes_mx_lw['id_mun'] = df_codes_mx_lw.NOM_ENT + df_codes_mx_lw.NOM_MUN\n",
    "\n",
    "\n",
    "\n",
    "df_join_pipe_code = pd.merge(df_pmx_00_19_lw,\n",
    "                             df_codes_mx_lw,\n",
    "                             on='id_mun',\n",
    "                             how='outer',\n",
    "                             indicator=True)\n",
    "\n",
    "\n",
    "sum.df_join_pipe_code['_merge']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 48,
   "id": "868f7777",
   "metadata": {},
   "outputs": [],
   "source": [
    "\n",
    "df_pmx_00_19_lw = df_pmx_00_19_lw.replace(\"Coahuila de Zaragoza\", \"Coahuila\")\n",
    "\n",
    "df_pmx_00_19_lw[\"estado\"] = df_pmx_00_19_lw[\"estado\"].str.lower().str.replace(' ', '').str.normalize('NFKD').str.encode('ascii',errors='ignore').str.decode('utf-8')\n",
    "df_pmx_00_19_lw[\"municipio\"] = df_pmx_00_19_lw[\"municipio\"].str.lower().str.replace(' ', '').str.normalize('NFKD').str.encode('ascii',errors='ignore').str.decode('utf-8')\n",
    "df_pmx_00_19_lw['id_mun'] = df_pmx_00_19_lw.estado + df_pmx_00_19_lw.municipio\n",
    "\n",
    "\n",
    "\n",
    "df_codes_mx_lw[\"NOM_ENT\"] = df_codes_mx_lw[\"NOM_ENT\"].str.lower().str.replace(' ', '').str.normalize('NFKD').str.encode('ascii',errors='ignore').str.decode('utf-8')\n",
    "df_codes_mx_lw[\"NOM_MUN\"] = df_codes_mx_lw[\"NOM_MUN\"].str.lower().str.replace(' ', '').str.normalize('NFKD').str.encode('ascii',errors='ignore').str.decode('utf-8')\n",
    "df_codes_mx_lw['id_mun'] = df_codes_mx_lw.NOM_ENT + df_codes_mx_lw.NOM_MUN\n",
    "\n",
    "\n",
    "\n",
    "df_join_pipe_code = pd.merge(df_pmx_00_19_lw,\n",
    "                             df_codes_mx_lw,\n",
    "                             on='id_mun',\n",
    "                             how='outer',\n",
    "                             indicator=True)\n",
    "\n",
    "\n",
    "describe.df_join_pipe_code['_merge']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 49,
   "id": "f3a66ac3",
   "metadata": {},
   "outputs": [],
   "source": [
    "\n",
    "df_pmx_00_19_lw = df_pmx_00_19_lw.replace(\"Coahuila de Zaragoza\", \"Coahuila\")\n",
    "\n",
    "df_pmx_00_19_lw[\"estado\"] = df_pmx_00_19_lw[\"estado\"].str.lower().str.replace(' ', '').str.normalize('NFKD').str.encode('ascii',errors='ignore').str.decode('utf-8')\n",
    "df_pmx_00_19_lw[\"municipio\"] = df_pmx_00_19_lw[\"municipio\"].str.lower().str.replace(' ', '').str.normalize('NFKD').str.encode('ascii',errors='ignore').str.decode('utf-8')\n",
    "df_pmx_00_19_lw['id_mun'] = df_pmx_00_19_lw.estado + df_pmx_00_19_lw.municipio\n",
    "\n",
    "\n",
    "\n",
    "df_codes_mx_lw[\"NOM_ENT\"] = df_codes_mx_lw[\"NOM_ENT\"].str.lower().str.replace(' ', '').str.normalize('NFKD').str.encode('ascii',errors='ignore').str.decode('utf-8')\n",
    "df_codes_mx_lw[\"NOM_MUN\"] = df_codes_mx_lw[\"NOM_MUN\"].str.lower().str.replace(' ', '').str.normalize('NFKD').str.encode('ascii',errors='ignore').str.decode('utf-8')\n",
    "df_codes_mx_lw['id_mun'] = df_codes_mx_lw.NOM_ENT + df_codes_mx_lw.NOM_MUN\n",
    "\n",
    "\n",
    "\n",
    "df_join_pipe_code = pd.merge(df_pmx_00_19_lw,\n",
    "                             df_codes_mx_lw,\n",
    "                             on='id_mun',\n",
    "                             how='outer',\n",
    "                             indicator=True)\n",
    "\n",
    "\n",
    "df_join_pipe_code['_merge'].summary"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 50,
   "id": "4c0a6477",
   "metadata": {},
   "outputs": [],
   "source": [
    "\n",
    "df_pmx_00_19_lw = df_pmx_00_19_lw.replace(\"Coahuila de Zaragoza\", \"Coahuila\")\n",
    "\n",
    "df_pmx_00_19_lw[\"estado\"] = df_pmx_00_19_lw[\"estado\"].str.lower().str.replace(' ', '').str.normalize('NFKD').str.encode('ascii',errors='ignore').str.decode('utf-8')\n",
    "df_pmx_00_19_lw[\"municipio\"] = df_pmx_00_19_lw[\"municipio\"].str.lower().str.replace(' ', '').str.normalize('NFKD').str.encode('ascii',errors='ignore').str.decode('utf-8')\n",
    "df_pmx_00_19_lw['id_mun'] = df_pmx_00_19_lw.estado + df_pmx_00_19_lw.municipio\n",
    "\n",
    "\n",
    "\n",
    "df_codes_mx_lw[\"NOM_ENT\"] = df_codes_mx_lw[\"NOM_ENT\"].str.lower().str.replace(' ', '').str.normalize('NFKD').str.encode('ascii',errors='ignore').str.decode('utf-8')\n",
    "df_codes_mx_lw[\"NOM_MUN\"] = df_codes_mx_lw[\"NOM_MUN\"].str.lower().str.replace(' ', '').str.normalize('NFKD').str.encode('ascii',errors='ignore').str.decode('utf-8')\n",
    "df_codes_mx_lw['id_mun'] = df_codes_mx_lw.NOM_ENT + df_codes_mx_lw.NOM_MUN\n",
    "\n",
    "\n",
    "\n",
    "df_join_pipe_code = pd.merge(df_pmx_00_19_lw,\n",
    "                             df_codes_mx_lw,\n",
    "                             on='id_mun',\n",
    "                             how='outer',\n",
    "                             indicator=True)\n",
    "\n",
    "\n",
    "df_join_pipe_code['_merge'].summary()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 51,
   "id": "62b93f97",
   "metadata": {},
   "outputs": [],
   "source": [
    "\n",
    "df_pmx_00_19_lw = df_pmx_00_19_lw.replace(\"Coahuila de Zaragoza\", \"Coahuila\")\n",
    "\n",
    "df_pmx_00_19_lw[\"estado\"] = df_pmx_00_19_lw[\"estado\"].str.lower().str.replace(' ', '').str.normalize('NFKD').str.encode('ascii',errors='ignore').str.decode('utf-8')\n",
    "df_pmx_00_19_lw[\"municipio\"] = df_pmx_00_19_lw[\"municipio\"].str.lower().str.replace(' ', '').str.normalize('NFKD').str.encode('ascii',errors='ignore').str.decode('utf-8')\n",
    "df_pmx_00_19_lw['id_mun'] = df_pmx_00_19_lw.estado + df_pmx_00_19_lw.municipio\n",
    "\n",
    "\n",
    "\n",
    "df_codes_mx_lw[\"NOM_ENT\"] = df_codes_mx_lw[\"NOM_ENT\"].str.lower().str.replace(' ', '').str.normalize('NFKD').str.encode('ascii',errors='ignore').str.decode('utf-8')\n",
    "df_codes_mx_lw[\"NOM_MUN\"] = df_codes_mx_lw[\"NOM_MUN\"].str.lower().str.replace(' ', '').str.normalize('NFKD').str.encode('ascii',errors='ignore').str.decode('utf-8')\n",
    "df_codes_mx_lw['id_mun'] = df_codes_mx_lw.NOM_ENT + df_codes_mx_lw.NOM_MUN\n",
    "\n",
    "\n",
    "\n",
    "df_join_pipe_code = pd.merge(df_pmx_00_19_lw,\n",
    "                             df_codes_mx_lw,\n",
    "                             on='id_mun',\n",
    "                             how='outer',\n",
    "                             indicator=True)\n",
    "\n",
    "\n",
    "df_join_pipe_code.summary()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 52,
   "id": "6b7d6d21",
   "metadata": {},
   "outputs": [],
   "source": [
    "\n",
    "df_pmx_00_19_lw = df_pmx_00_19_lw.replace(\"Coahuila de Zaragoza\", \"Coahuila\")\n",
    "\n",
    "df_pmx_00_19_lw[\"estado\"] = df_pmx_00_19_lw[\"estado\"].str.lower().str.replace(' ', '').str.normalize('NFKD').str.encode('ascii',errors='ignore').str.decode('utf-8')\n",
    "df_pmx_00_19_lw[\"municipio\"] = df_pmx_00_19_lw[\"municipio\"].str.lower().str.replace(' ', '').str.normalize('NFKD').str.encode('ascii',errors='ignore').str.decode('utf-8')\n",
    "df_pmx_00_19_lw['id_mun'] = df_pmx_00_19_lw.estado + df_pmx_00_19_lw.municipio\n",
    "\n",
    "\n",
    "\n",
    "df_codes_mx_lw[\"NOM_ENT\"] = df_codes_mx_lw[\"NOM_ENT\"].str.lower().str.replace(' ', '').str.normalize('NFKD').str.encode('ascii',errors='ignore').str.decode('utf-8')\n",
    "df_codes_mx_lw[\"NOM_MUN\"] = df_codes_mx_lw[\"NOM_MUN\"].str.lower().str.replace(' ', '').str.normalize('NFKD').str.encode('ascii',errors='ignore').str.decode('utf-8')\n",
    "df_codes_mx_lw['id_mun'] = df_codes_mx_lw.NOM_ENT + df_codes_mx_lw.NOM_MUN\n",
    "\n",
    "\n",
    "\n",
    "df_join_pipe_code = pd.merge(df_pmx_00_19_lw,\n",
    "                             df_codes_mx_lw,\n",
    "                             on='id_mun',\n",
    "                             how='outer',\n",
    "                             indicator=True)\n",
    "\n",
    "\n",
    "df_join_pipe_code['_merge'].describe()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 53,
   "id": "dc882f9b",
   "metadata": {},
   "outputs": [],
   "source": [
    "\n",
    "df_pmx_00_19_lw = df_pmx_00_19_lw.replace(\"Coahuila de Zaragoza\", \"Coahuila\")\n",
    "\n",
    "df_pmx_00_19_lw[\"estado\"] = df_pmx_00_19_lw[\"estado\"].str.lower().str.replace(' ', '').str.normalize('NFKD').str.encode('ascii',errors='ignore').str.decode('utf-8')\n",
    "df_pmx_00_19_lw[\"municipio\"] = df_pmx_00_19_lw[\"municipio\"].str.lower().str.replace(' ', '').str.normalize('NFKD').str.encode('ascii',errors='ignore').str.decode('utf-8')\n",
    "df_pmx_00_19_lw['id_mun'] = df_pmx_00_19_lw.estado + df_pmx_00_19_lw.municipio\n",
    "\n",
    "\n",
    "\n",
    "df_codes_mx_lw[\"NOM_ENT\"] = df_codes_mx_lw[\"NOM_ENT\"].str.lower().str.replace(' ', '').str.normalize('NFKD').str.encode('ascii',errors='ignore').str.decode('utf-8')\n",
    "df_codes_mx_lw[\"NOM_MUN\"] = df_codes_mx_lw[\"NOM_MUN\"].str.lower().str.replace(' ', '').str.normalize('NFKD').str.encode('ascii',errors='ignore').str.decode('utf-8')\n",
    "df_codes_mx_lw['id_mun'] = df_codes_mx_lw.NOM_ENT + df_codes_mx_lw.NOM_MUN\n",
    "\n",
    "\n",
    "\n",
    "df_join_pipe_code = pd.merge(df_pmx_00_19_lw,\n",
    "                             df_codes_mx_lw,\n",
    "                             on='id_mun',\n",
    "                             how='outer',\n",
    "                             indicator=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 54,
   "id": "674d38b3",
   "metadata": {},
   "outputs": [],
   "source": [
    "df_join_pipe_code['codigo inegi'] = df_join_pipe_code['codigo inegi'].str.zfill(2)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 55,
   "id": "a3b0304a",
   "metadata": {},
   "outputs": [],
   "source": [
    "class(df_join_pipe_code['codigo inegi'] = df_join_pipe_code['codigo inegi'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 56,
   "id": "675a3a0c",
   "metadata": {},
   "outputs": [],
   "source": [
    "class(df_join_pipe_code['codigo inegi'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 57,
   "id": "4c8e856c",
   "metadata": {},
   "outputs": [],
   "source": [
    "type(df_join_pipe_code['codigo inegi'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 58,
   "id": "22a1743e",
   "metadata": {},
   "outputs": [],
   "source": [
    "df_join_pipe_code.dtypes"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 59,
   "id": "9dbbcc1d",
   "metadata": {},
   "outputs": [],
   "source": [
    "%cd \"Documents/GitHub/pmx_gasoline_theft_prediction/\""
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 60,
   "id": "a51dea37",
   "metadata": {},
   "outputs": [],
   "source": [
    "  %notebook \"01_Wrangle_data_PMX_code.ipynb\"     "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 61,
   "id": "df584333",
   "metadata": {},
   "outputs": [],
   "source": [
    "  %notebook \"analysis/01_Wrangle_data_PMX_code.ipynb\"     "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 62,
   "id": "c0101cfe",
   "metadata": {},
   "outputs": [],
   "source": [
    "  %notebook \"analysis/\""
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 63,
   "id": "5cd6c9a5",
   "metadata": {},
   "outputs": [],
   "source": [
    "  %notebook \"analysis/01_Wrangle_data_PMX_code.ipynb\""
   ]
  }
 ],
 "metadata": {},
 "nbformat": 4,
 "nbformat_minor": 5
}
